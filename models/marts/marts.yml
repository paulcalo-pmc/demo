version: 2

models:

  - name: fact_sales
    description: >
      This model produces an item-level sales fact table filtered to the first
      month in which any store sales occurred. It joins the staged store sales
      data with the item dimension to enrich each transaction with item category
      information. Revenue is calculated directly and again using a macro to
      demonstrate reusable business logic in dbt.

    columns:
      - name: item_id
        #tests:
          #- not_null
          #- relationships:
              #arguments:
                #to: ref('dim_item')
                #field: item_id

      - name: customer_id
        #tests:
          #- not_null
          #- relationships:
              #arguments:
                #to: ref('dim_customer')
                #field: customer_id

      - name: revenue
        #tests:
          #- not_null

      - name: date_key
        tests:
          - not_null

